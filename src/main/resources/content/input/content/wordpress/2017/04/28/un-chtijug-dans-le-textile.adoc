:jbake-type: post
:jbake-status: published
:jbake-title: Un chtijug dans le textile
:jbake-tags: api,chtijug,docker,http,proxy,_mois_avr.,_annÃ©e_2017
:jbake-date: 2017-04-28
:jbake-depth: ../../../../
:jbake-uri: wordpress/2017/04/28/un-chtijug-dans-le-textile.adoc
:jbake-excerpt: 
:jbake-source: https://riduidel.wordpress.com/2017/04/28/un-chtijug-dans-le-textile/
:jbake-style: wordpress

++++
<p>
<div class="paragraph">Et paf, un chtijug pas Ã  petit prix chez kiabi ! Le site est plutÃ´t sympa, avec un cÃ´tÃ© plateforme pour thÃ©atre dâ€™improvisation (par contre, les spots du fond qui clignotent, Ã§a va pas Ãªtre pratique pour les Ã©pileptiques). Julien (du chtijug) est bien content quâ€™on sorte des Ã©ternels ISEN/IUT B â€¦â€‹ et moi aussi : aller faire ces confÃ©rences dans des entreprises, pour des dÃ©veloppeurs professionnels, câ€™est effectivement mieux.</div>
<br/>
<div class='twitter'>
<br/>
<span class="twitter_status">
</p>
<p>
<span class="author">
</p>
<p>
<a href="http://twitter.com/sebastienfriess" class="screenName"><img src="http://pbs.twimg.com/profile_images/1210282851817738240/UAsY6u4L_mini.jpg" alt="profile of Directeur Engineering @sfeirlille, dev certifiÃ© #GCP,   #velotafeur, #golang #running #rum. Mes tweets nâ€™engagent que moi."/>sebastienfriess</a>
<br/>
<span class="name">Seb FRIÎSS ğŸš´ğŸ»ğŸƒğŸ»â€â™‚ï¸</span>
</p>
<p>
</span>
</p>
<p>
<a href="https://twitter.com/sebastienfriess/status/857Â 641Â 829Â 281Â 517Â 569" class="date">27 avr. 2017 Ã  19:05:20</a>
</p>
<p>
<span class="content">
</p>
<p>
<span class="text">C'est parti pour le @chtijug #API. @loicmathieu on stage pour nous prÃ©senter le cas  @KiabiFrance suivi de @traefikproxy avec @emilevauge https://t.co/mXxQ7OMuKP</span>
</p>
<p>
<span class="medias">
<br/>
<span class="media media-photo">
<br/>
<img src="http://pbs.twimg.com/media/C-b0roaXYAYzPp7.jpg" alt="857Â 641Â 809Â 480Â 212Â 486"/>
<br/>
</span>
<br/>
</span>
</p>
<p>
</span>
</p>
<p>
<span class="twitter_status_end"/>
<br/>
</span>
<br/>
</div>
<br/>
<h1 id="_openapi_chez_kiabi" class="sect0">OpenAPI chez Kiabi</h1>
<br/>
Il y a deux ans, Kiabi a lancÃ© une API web. Je ne vais pas vous reprendre tout lâ€™argumentaire dÃ©veloppÃ© par le speaker sur les API, parce que personnellement, je connais dÃ©ja (oui, je ne suis pas vraiment pÃ©dagogue). Cela dit, il explique bien les diffÃ©rents aspects positifs de la dÃ©finition dâ€™une API (quand les slides seront disponibles, ce sera plus clair). Lâ€™un des plus grands bÃ©nÃ©fices Ã©tant Ã©videment lâ€™accÃ©lÃ©ration des dÃ©veloppements : en dÃ©couplant le dÃ©veloppement back-end et le dÃ©veloppement front-end, on peut accÃ©lerer ce dernier.
<br/>
<div class="paragraph">
</p>
<p>
OpenAPI, câ€™est le troisiÃ¨me niveau du dÃ©veloppement dâ€™API dans l'Ã©chelle suivante :
</p>
<p>
</div>
<br/>
<div class="olist arabic">
<br/>
<ol class="arabic">
<br/>
<li>API interne</li>
<br/>
<li>API publique, mais uniquement exposÃ©e aux partenaires (avec Ã©videment de lâ€™OAuth, et peut-Ãªtre de lâ€™API management)</li>
<br/>
<li>API publique, exposÃ©e et source de revenus.</li>
<br/>
</ol>
<br/>
</div>
<br/>
<div class="sect1">
<br/>
<h2 id="_d_finition">DÃ©finition</h2>
<br/>
<div class="sectionbody">
<br/>
<div class="paragraph">
</p>
<p>
Pour dÃ©velopper lâ€™API, Kiabi a dâ€™abord dÃ©fini des concepts gÃ©nÃ©raux :
</p>
<p>
</div>
<br/>
<div class="ulist">
<br/>
<ul>
<br/>
<li>API Kiss
<br/>
<div class="ulist">
<br/>
<ul>
<br/>
<li>incluant une API affordance, câ€™est-Ã -dire intuitive dans son usage, et suggÃ©rant mÃªme ses bons usages</li>
<br/>
<li>avec une sÃ©mantique claire</li>
<br/>
<li>et en ne fournissant quâ€™une seule faÃ§on de faire une chose</li>
<br/>
</ul>
<br/>
</div></li>
<br/>
<li>RÃ©utiliser des standards et des types dâ€™API existant</li>
<br/>
</ul>
<br/>
</div>
<br/>
<div class="paragraph">
</p>
<p>
Par contre, il faut Ã©viter dâ€™utiliser le jargon fonctionnel interne (ce qui est un point Ã  mon sens super intÃ©ressant). Laissez-moi dÃ©tailler ce point un instant. Dans votre entreprise, vos fonctionnels sont lÃ  pour dÃ©finir le vocabulaire mÃ©tier. Vous comptez sur leur sÃ©rieux. Mais quand vous dÃ©veloppez une API publique, vous n'utilisez pas ce vocabulaire ... C'est de la schizophrÃ©nie ? Non, Ã  mon avis, c'est plutÃ´t que le vocabulaire interne dÃ©rive, se jargonifie, et perd son adhÃ©rence avec le rÃ©el. Du coup, c'est DDD ou pas ? A mon avis, et contrairement Ã  certain homonyme, oui.
</p>
<p>
A partir de ces concepts, Kiabi a dÃ©fini une refcard qui reprend lâ€™ensemble des concepts et des rÃ¨gles de fonctionnement dÃ©finies. Chose curieuse, cette refacrd inclut la liste des codes HTTP retournÃ©s par les applications Kiabi. Ca me paraÃ®t curieux : le W3C a dÃ©fini ces codes pour des raisons qui peuvent arriver, non ? Alors pourquoi ne pas tous les utiliser ?
</p>
<p>
<div class='twitter'>
<br/>
<span class="twitter_status">
</p>
<p>
<span class="author">
</p>
<p>
<a href="http://twitter.com/jak78" class="screenName"><img src="http://pbs.twimg.com/profile_images/378800000088121039/b4e73262ceb62ea0c3721ce37cccaed7_mini.jpeg" alt="profile of Helping companies to build amazing software&teams, founder @OCTOChti, @chtijug, @nordagile, Soft. craft. Lille, Culture Code author https://t.co/ZdVAWvMCE1"/>jak78</a>
<br/>
<span class="name">Julien Jakubowski</span>
</p>
<p>
</span>
</p>
<p>
<a href="https://twitter.com/jak78/status/858Â 003Â 308Â 136Â 595Â 456" class="date">28 avr. 2017 Ã  19:01:44</a>
</p>
<p>
<span class="content">
</p>
<p>
<span class="text">La refcard API sur laquelle s'est basÃ© Kiabi @chtijug #api #kiabi  https://t.co/oizulcryMT</span>
</p>
<p>
<span class="medias">
<br/>
</span>
</p>
<p>
</span>
</p>
<p>
<span class="twitter_status_end"/>
<br/>
</span>
<br/>
</div>
</p>
<p>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div class="sect1">
<br/>
<h2 id="_impl_mentation">ImplÃ©mentation</h2>
<br/>
<div class="sectionbody">
<br/>
<div class="paragraph">
</p>
<p>
Et donc, les implÃ©menteurs implÃ©mentent leur API Ã  partir de ces rÃ¨gles, et elle est dÃ©finie en comitÃ© (argh) avec une platrÃ©e dâ€™architectes transverses (re-argh). Evidement, Ã§a qualifie le projet comme non-agile, mais en un sens, je comprend le besoin de cohÃ©rence du bazar. Et de la mÃªme maniÃ¨re, lâ€™implÃ©mentation se fait sur une plateforme standard : Tomcat, CXF, JSON, â€¦â€‹
</p>
<p>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div class="sect1">
<br/>
<h2 id="_management">Management</h2>
<br/>
<div class="sectionbody">
<br/>
<div class="paragraph">
</p>
<p>
Pour gÃ©rer tout Ã§a, Kiabi a mis en place un API Manager (Software AG Webmethods API machintruc) qui ne semble pas fournir tous les services, puisquâ€™il y a quand mÃªme un Apache en frontal (apparemment pour faire de lâ€™URI rewriting). Ils ont Ã©galement un portail dâ€™API pour dÃ©veloppeur, Ã©videment indispensable pour permettre aux dÃ©veloppeurs dâ€™utiliser les diffÃ©rentes API proposÃ©es. Dâ€™une faÃ§on amusante, le speaker insiste lourdement sur le fait que ce portail dâ€™API permet aux dÃ©veloppeurs dâ€™utiliser facilement les diffÃ©rentes API. Ca trahit Ã  mon sens plus le choc culturel quâ€™est cette ouverture que le challenge technique de ce portail (ne serait-ce que parce que <a href="https://api.stackexchange.com/">StackOverflow</a>, <a href="https://www.goodreads.com/api">Goodreads</a>, le fournissent dÃ©ja depuis â€¦â€‹ quoi â€¦â€‹ 5 ans ?).
</p>
<p>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<div class="sect1">
<br/>
<h2 id="_d_mo">DÃ©mo</h2>
<br/>
<div class="sectionbody"></div>
<br/>
</div>
<br/>
<div class="sect1">
<br/>
<h2 id="_pub">Pub</h2>
<br/>
<div class="sectionbody">
<br/>
<div class="paragraph">
</p>
<p>
Kiabi organise au mois de juin un hackathon. Bon, personnellement, je ne suis pas fan de ce genre d'Ã©vÃ©nements. Mais si Ã§a vous branche â€¦â€‹
</p>
<p>
</div>
<br/>
</div>
<br/>
</div>
<br/>
<h1 id="_traefik" class="sect0">traefik</h1>
<br/>
<div class='twitter'>
<br/>
<span class="twitter_status">
</p>
<p>
<span class="author">
</p>
<p>
<a href="http://twitter.com/BnJ25" class="screenName"><img src="http://pbs.twimg.com/profile_images/1344603956153114625/0I1zIWbC_mini.jpg" alt="profile of ğŸ‡§ğŸ‡ª lost in Paris playing with @rustlang at @CosmianOfficial. Zero copy Rustacean contributing to @rust_analyzer and https://t.co/nxADLEeyHs ex #ovh #golang"/>BnJ25</a>
<br/>
<span class="name">Benjamin Coenen ğŸ‡§ğŸ‡ª ğŸ¦€</span>
</p>
<p>
</span>
</p>
<p>
<a href="https://twitter.com/BnJ25/status/857Â 652Â 264Â 202Â 383Â 361" class="date">27 avr. 2017 Ã  19:46:48</a>
</p>
<p>
<span class="content">
</p>
<p>
<span class="text">Talk de @emilevauge sur @traefikproxy ğŸ’ªğŸ» au @chtijug ! #golang https://t.co/5xIcEGMB4M</span>
</p>
<p>
<span class="medias">
<br/>
<span class="media media-photo">
<br/>
<img src="http://pbs.twimg.com/media/C-b-K-0XgAAwfjv.jpg" alt="857Â 652Â 243Â 675Â 447Â 296"/>
<br/>
</span>
<br/>
</span>
</p>
<p>
</span>
</p>
<p>
<span class="twitter_status_end"/>
<br/>
</span>
<br/>
</div>
<br/>
<div class="paragraph">
</p>
<p>
Pourquoi faire un autre reverse proxy (par rapport Ã , par exemple, nginx ou HAProxy) ? A cause des miccroservices.
</p>
<p>
</div>
<br/>
<div class="paragraph">
</p>
<p>
Avec les microservices, on gagne un tas de nouveaux outils :
</p>
<p>
</div>
<br/>
<div class="ulist">
<br/>
<ul>
<br/>
<li>Des conteneurs (Docker, rkt)</li>
<br/>
<li>Des orchestrateurs (Docker Swarm, Kubernetes, Mesos, Rancher)</li>
<br/>
<li>Des outils de service discovery (etcd, Consul, Zookeeper)</li>
<br/>
<li>Et des reverse proxy</li>
<br/>
</ul>
<br/>
</div>
<br/>
<div class="paragraph">
</p>
<p>
A quoi Ã§a sert ? A connecter le rÃ©seau privÃ© au web en respectant l'Ã©tat des microservices. Souvenez-vous, Christophe Furmaniak en avait dÃ©ja parlÃ© lors dâ€™<a href="https://riduidel.wordpress.com/2016/03/30/rancheros-au-chtijug/">une session sur Rancher</a>.
</p>
<p>
</div>
<br/>
<div class="paragraph">
</p>
<p>
Les reverse-proxyes open-source (HAProxy et nginx) ont une configuration statique. Du coup, quand les microservices sont dÃ©ployÃ©s, il faut
</p>
<p>
</div>
<br/>
<div class="olist arabic">
<br/>
<ol class="arabic">
<br/>
<li>ArrÃªter le proxy</li>
<br/>
<li>Changer la configuration</li>
<br/>
<li>RedÃ©marrer le proxy</li>
<br/>
</ol>
<br/>
</div>
<br/>
<div class="paragraph">
</p>
<p>
Pas trÃ¨s pratique.
</p>
<p>
</div>
<br/>
<div class="paragraph">
</p>
<p>
traefik, lui, lit sa configuration depuis lâ€™orchestrateur. Du coup, pas besoin de redÃ©marrage. PlutÃ´t cool â€¦â€‹ Et pour Ãªtre rapide, câ€™est du go. Et dâ€™un coup, je comprend pourquoi le go progresse : avec le build statique, une image Docker dâ€™un programme go ne contient pas de dÃ©pendances, et câ€™est chouette ! (pour ceux qui aiment Ã§a). Attention, je ne dis pas que c'est bien. Je dis juste que Go est plutÃ´t bien adaptÃ© au monde Docker.<strong>
<br/>
</strong>
</p>
<p>
</div>
<br/>
<div class="sect1">
<br/>
<h2 id="_d_mo_2">DÃ©mo</h2>
<br/>
<div class='twitter'>
<br/>
<span class="twitter_status">
</p>
<p>
<span class="author">
</p>
<p>
<a href="http://twitter.com/sebastienfriess" class="screenName"><img src="http://pbs.twimg.com/profile_images/1210282851817738240/UAsY6u4L_mini.jpg" alt="profile of Directeur Engineering @sfeirlille, dev certifiÃ© #GCP,   #velotafeur, #golang #running #rum. Mes tweets nâ€™engagent que moi."/>sebastienfriess</a>
<br/>
<span class="name">Seb FRIÎSS ğŸš´ğŸ»ğŸƒğŸ»â€â™‚ï¸</span>
</p>
<p>
</span>
</p>
<p>
<a href="https://twitter.com/sebastienfriess/status/857Â 658Â 456Â 505Â 016Â 320" class="date">27 avr. 2017 Ã  20:11:25</a>
</p>
<p>
<span class="content">
</p>
<p>
<span class="text">.@chtijug @loicmathieu @KiabiFrance @traefikproxy @emilevauge .@kubernetesio live demo with @traefikproxy #cheese ğŸ˜ https://t.co/4lpERJ3LEZ</span>
</p>
<p>
<span class="medias">
<br/>
<span class="media media-photo">
<br/>
<img src="http://pbs.twimg.com/media/C-cDztaXUAIpqSL.jpg" alt="857Â 658Â 440Â 935Â 755Â 778"/>
<br/>
</span>
<br/>
</span>
</p>
<p>
</span>
</p>
<p>
<span class="twitter_status_end"/>
<br/>
</span>
<br/>
</div>
<br/>
<div class="sectionbody">
<br/>
<div class="paragraph">Et dâ€™un coup, je comprend <a href="http://blog.lecacheur.com/2017/03/07/pourquoi-utiliser-un-gestionnaire-dabreviation/">lâ€™affection de Quentin Adam pour les gestionnaires dâ€™abrÃ©viation</a> : lancer des conteneurs docker en ligne de commande pendant une dÃ©mo, Ã§a peut merder facilement â€¦â€‹ Parce qu'Emile a eu quelques soucis liÃ©s Ã  la connexion internet ... sensible et aux commandes docker un peu longues.</div>
<br/>
</div>
<br/>
</div>
<br/>
<div class='twitter'>
<br/>
https://twitter.com/cyril_lakech/status/857940064785006594
<br/>
</div>
</p>
++++